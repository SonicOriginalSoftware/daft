# An example pipeline file

- events:
  - post_receive:
      branches: ['production']

- env:
    ENV: 'PRODUCTION'

- stages:
  - build:
      resources: ['shared/image.png']
      jobs:
        - build_for_linux:
            attributes:
              shell: 'posix'
              os: 'linux'
              arch: 'x86_64'
            script: scripts/build.sh
            artifacts:
              build: 'path-to-build-folder'

        - build_for_windows:
            attributes:
              shell: 'powershell'
              os: 'windows'
              arch: 'x86_64'
            script: scripts/build.ps1

  - test:
      env:
        ENV: 'TEST'
      resources: []
      jobs:
        - test_for_linux:
            attributes:
              shell: 'posix'
              os: 'linux'
              arch: 'x86_64'
            script: scripts/test.sh

  - deploy:
      resources: []
      jobs:
        - deploy:
            env:
              ENV: 'DEPLOY'
            attributes:
              shell: 'posix'
              os: 'any'
              arch: 'x86_64'
            script: scripts/deploy.sh

  - notify:
      if: always()
      jobs:
        - deploy:
            attributes:
              shell: 'posix'
              os: 'any'
              arch: 'x86_64'
            script: notify.sh

